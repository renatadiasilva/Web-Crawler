/*! cnn-video-loader 1.3.7 2015-05-11 */
CNNVIDEOAPI.EventSubscriberBase=CNNVIDEOAPI.ClassBase.extend({init:function(publisher,topic){this.publisher=publisher,this.methodsToSubscribeTo=[],this.topic=topic,this.initMethods(),this.doSubscribe()},initMethods:function(){throw Error("You must override the CNNVIDEOAPI.EventSubscriberBase.initMethods method")},receiveNotification:function(requestingPublisher,topicName,functionName,args){if(this.topic===topicName&&this.publisher===requestingPublisher&&this.methodsToSubscribeTo.indexOf(functionName)>=0){var fn=this[functionName];"function"==typeof fn&&fn.apply(this,args)}},doSubscribe:function(){this.topic&&this.publisher.subscribe(this.topic,jQuery.proxy(this.receiveNotification,this))}}),CNNVIDEOAPI.CVPEventSubscriber=CNNVIDEOAPI.EventSubscriberBase.extend({init:function(publisher,eventDispatcher,videoConfig,topic){this.eventDispatcher=eventDispatcher,this.videoConfig=videoConfig?videoConfig:{},this._super(publisher,topic?topic:"cvpEventHandler")},receiveNotification:function(){var args=[].slice.apply(arguments),evt=args.shift(),functionName=evt.type,argsArray=Array.isArray(args)?args:[args],merged=jQuery.merge([evt],argsArray);if(this.methodsToSubscribeTo.indexOf(functionName)>=0){var fn=this[functionName];"function"==typeof fn&&fn.apply(this,merged)}},doSubscribe:function(){if(this.topic)for(var i=0;this.methodsToSubscribeTo.length>i;i++){var functionName=this.methodsToSubscribeTo[i];if(this.methodsToSubscribeTo.indexOf(functionName)>=0){var fn=this[functionName];"function"==typeof fn&&jQuery(this.eventDispatcher).on(functionName,jQuery.proxy(fn,this))}}}}),CNNVIDEOAPI.APIVideoHelperEventHandler=CNNVIDEOAPI.EventSubscriberBase.extend({init:function(publisher){this._super(publisher,"apiVideoHelperEvent")},initMethods:function(){this.methodsToSubscribeTo="onAdPlay onContentPlay onContentBegin onContentPause".split(" ")},onAdPlay:function(containerId){CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(containerId)},onContentPlay:function(containerId){CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(containerId)},onContentBegin:function(containerId){CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(containerId)},onContentPause:function(containerId,cvpId,contentId,paused){(paused===!1||"false"===paused)&&CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(containerId)}}),CNNVIDEOAPI.CVPEventPostMessageDispatcher=CNNVIDEOAPI.CVPEventSubscriber.extend({init:function(publisher,eventDispatcher,videoConfig){this._super(publisher,eventDispatcher,videoConfig,"cvpIframePostMessageDispatcher")},initMethods:function(){this.methodsToSubscribeTo="onPlayerReady onContentPlayhead onCVPReady onContentBegin onContentPlay onContentPause onContentEnd onContentComplete onContentMetadata onContentBuffering onContentResize onContentVolume onContentError onAdPlay onAdEnd onAdError onTrackingAdStart onTrackingAdComplete onTrackingAdCountdown onTrackingContentPlay onTrackingContentBegin onTrackingContentComplete onTrackingContentSeek onTrackingFullscreen onTrackingMuted onTrackingPaused".split(" ");var pointer=this;jQuery(".videoHeadline").hide();for(var i=0,l=this.methodsToSubscribeTo.length;l>i;i++){var name=this.methodsToSubscribeTo[i];this[name]=this.proxyEvent.call(pointer,name)}},proxyEvent:function(name){return function(){var argv=[].slice.apply(arguments);argv.shift();var data=argv,eventData=[];if(eventData.push(window.frameName),data.length>=1)for(var paramsInd=1;data.length>paramsInd;paramsInd++){var paramVal=data[paramsInd];eventData.push(paramVal)}var evt={action:"event",name:window.frameName,type:name,data:data,event:eventData};jQuery.postMessage(evt,window.framePath)}}}),CNNVIDEOAPI.ClientEventCallbacksWrapper=CNNVIDEOAPI.EventSubscriberBase.extend({init:function(publisher,eventCallback){this.eventsCallback=eventCallback,this._super(publisher,"clientEventWrapper")},initMethods:function(){for(var functionName in this.eventsCallback){var fn=this.eventsCallback[functionName];"function"==typeof fn&&(this[functionName]=fn,this.methodsToSubscribeTo.push(functionName))}}}),CNNVIDEOAPI.JSMDAnalyticsEventHandler=CNNVIDEOAPI.CVPEventSubscriber.extend({init:function(publisher,eventDispatcher,videoConfig,analyticsConfig){this.jsmdLocal={},this.analyticsConfig=analyticsConfig,this.initialize(),this._super(publisher,eventDispatcher,videoConfig,"jsmdAnalytics")},initialize:function(){if(this.analyticsConfig&&this.analyticsConfig.metadata)for(var metaName in this.analyticsConfig.metadata)CNNVIDEOAPI.Utils.generateWindowVariables(metaName,this.analyticsConfig.metadata[metaName])},initMethods:function(){this.methodsToSubscribeTo="onPlayerReady onContentBegin onContentPlay onContentComplete onContentPlayhead onAdPlay onContentPause onTrackingContentSeek onContentBuffering onTrackingFullscreen".split(" ")},getVideoInstance:function(){return this.publisher&&this.publisher.videoInstance?(this.vInst=this.publisher.videoInstance,this.vInst):{cvp:{}}},onPlayerReady:function(){try{var cvp=this.getVideoInstance().cvp;cvp.setAdKeyValue("transactionID",cnnad_transactionID),cvp.setAdKeyValue("guID",cnnad_readCookie("ug"))}catch(err){}},onContentBegin:function(evt,containerId,playerId,contentId){window.debugMsg("onContentBegin in JSMDAnalyticsHandler: containerId:"+containerId),!window.jsmd&&_jsmd&&(window.jsmd=_jsmd.init()),this.jsmdLocal.META=new window._jsmd.plugin.gCNNVideoCollection,this.getVideoInstance()&&this.getVideoInstance().videoMetadata&&delete this.getVideoInstance().videoMetadata;try{this.getVideoInstance().getContentEntry&&this.getVideoInstance().getContentEntry(contentId)}catch(error){}this.jsmdLocal.CONTENT=this.getVideoInstance().videoMetadata?this.getVideoInstance().videoMetadata:{id:contentId}},onContentPlay:function(evt,containerId,playerId,contentId){var eventType="video-start";this.getVideoInstance().isUnAuthLive&&this.getVideoInstance().isUnAuthLive(contentId)&&(eventType="video-live"),window.sendVideo2Event(this.jsmdLocal.CONTENT,eventType,playerId)},onContentComplete:function(evt,containerId,playerId){window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-complete",playerId)},onContentPlayhead:function(evt,containerId,playerId,contentId,playhead,duration){void 0===this.jsmdLocal.META||void 0===playhead||this.jsmdLocal.META.get(contentId,"hasScrubbed")||(playhead>.75*duration&&!this.jsmdLocal.META.get(contentId,"isSeventyFive")?window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-seventyfive",playerId):playhead>.5*duration&&!this.jsmdLocal.META.get(contentId,"isHalf")?window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-fifty",playerId):playhead>.25*duration&&!this.jsmdLocal.META.get(contentId,"isTwentyFive")?window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-twentyfive",playerId):playhead>.1*duration&&!this.jsmdLocal.META.get(contentId,"isTen")&&window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-ten",playerId))},onAdPlay:function(evt,containerId,playerId,token,mode,id,duration){this.jsmdLocal.CONTENT.ad_duration=duration,window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-preroll",playerId)},onTrackingFullscreen:function(evt,containerId,playerId,dataObj){var cvp=this.getVideoInstance().cvp?this.getVideoInstance().cvp:{};if(dataObj.fullscreen)try{cvp.setMaxBitrate(this.getVideoInstance().config.fullscreenbitrate)}catch(error){}},onContentPause:function(evt,containerId,playerId){window.debugMsg("JSMDAnalyticsEventHandler onContentPause: containerId:"+containerId),window.sendVideo2Event(evt,this.jsmdLocal.CONTENT,"video-pause",playerId)},onTrackingContentSeek:function(evt,containerId,playerId){window.debugMsg("JSMDAnalyticsEventHandler onTrackingContentSeek: containerId:"+containerId),window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-scrub",playerId)},onContentBuffering:function(evt,containerId,playerId){window.debugMsg("JSMDAnalyticsEventHandler onContentBuffering: containerId:"+containerId),window.sendVideo2Event(this.jsmdLocal.CONTENT,"video-buffer",playerId)}}),CNNVIDEOAPI.JSMDNewAPIVideoTrackingEventHandler=CNNVIDEOAPI.CVPEventSubscriber.extend({init:function(publisher,eventDispatcher,videoConfig,analyticsConfig){this.jsmdLocal={},this.analyticsConfig=analyticsConfig,this.initialize(),this._super(publisher,eventDispatcher,videoConfig,"jsmdAnalyticsNewAPI")},initialize:function(){if(this.analyticsConfig&&this.analyticsConfig.metadata)for(var metaName in this.analyticsConfig.metadata)window.debugMsg("JSMDNewAPIVideoTrackingEventHandler will set metadata for variable'"+metaName+"' to "+(""+this.analyticsConfig.metadata[metaName])+". If you don't want didn't want to set this variable in the loader, please check your analytics configuration"),CNNVIDEOAPI.Utils.generateWindowVariables(metaName,this.analyticsConfig.metadata[metaName])},initMethods:function(){this.methodsToSubscribeTo="onContentReplayRequest onPlayerReady onContentBegin onContentPlay onContentEnd onContentPlayhead onAdPlay onAdEnd onContentPause onTrackingContentSeek onContentBuffering onTrackingFullscreen".split(" ")},getVideoInstance:function(){return this.publisher&&this.publisher.videoInstance?(this.vInst=this.publisher.videoInstance,this.vInst):{cvp:{}}},getPlayerId:function(defaultValue){return(!this.publisher||this.publisher instanceof CNNVIDEOAPI.CNNVideoPlayerBase)&&this.publisher.getGUID()?this.publisher.getGUID():defaultValue},onPlayerReady:function(evt,containerId,playerId){try{playerId=this.getPlayerId(playerId);var cvp=this.getVideoInstance().cvp;cvp.setAdKeyValue("transactionID",cnnad_transactionID),cvp.setAdKeyValue("guID",cnnad_readCookie("ug"))}catch(err){}},onContentBegin:function(evt,containerId,playerId,contentId){window.debugMsg("onContentBegin in JSMDAnalyticsHandler: containerId:"+containerId),!window.jsmd&&_jsmd&&(window.jsmd=_jsmd.init()),this.jsmdLocal.META=new window._jsmd.plugin.gCNNVideoCollection,this.getVideoInstance()&&this.getVideoInstance().videoMetadata&&delete this.getVideoInstance().videoMetadata;try{this.getVideoInstance().getContentEntry&&this.getVideoInstance().getContentEntry(contentId)}catch(error){}this.jsmdLocal.CONTENT=this.getVideoInstance().videoMetadata?this.getVideoInstance().videoMetadata:{id:contentId}},hasAutoStartFlagSet:function(config){return"object"==typeof config&&config.autostart!==void 0?config.autostart===!0||"true"===config.autostart:!1},onContentPlay:function(evt,containerId,playerId,contentId){var eventType="cnnvideo-start",hasVideoCollection="object"==typeof this.videoConfig&&"string"==typeof this.videoConfig.videoCollection,hasAutoPlayFlagSet=this.hasAutoStartFlagSet(this.videoConfig);if(playerId=this.getPlayerId(playerId),this.getVideoInstance().isUnAuthLive&&this.getVideoInstance().isUnAuthLive(contentId)?eventType="cnnvideo-live":!hasAutoPlayFlagSet||this.jsmdLocal.replayVidId&&this.jsmdLocal.replayVidId===contentId?(eventType="cnnvideo-start",this.jsmdLocal.replayVidId=""):eventType="cnnvideo-autostart",hasVideoCollection)this.jsmdLocal.CONTENT.video_collection=hasVideoCollection?this.videoConfig.videoCollection:"";else if(this.jsmdLocal.CONTENT.video_collection!==void 0)try{delete this.jsmdLocal.CONTENT.video_collection}catch(error){}window.trackVideoEvent(this.jsmdLocal.CONTENT,eventType,playerId)},onContentReplayRequest:function(evt,containerId,playerId,contentId){this.jsmdLocal.replayVidId=contentId},onContentEnd:function(evt,containerId,playerId){playerId=this.getPlayerId(playerId),window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-complete",playerId)},onContentPlayhead:function(evt,containerId,playerId,contentId,playhead,duration){playerId=this.getPlayerId(playerId),void 0===this.jsmdLocal.META||void 0===playhead||this.jsmdLocal.META.get(playerId,"hasScrubbed")||(playhead>.75*duration&&!this.jsmdLocal.META.get(playerId,"isSeventyFive")?window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-seventyfive",playerId):playhead>.5*duration&&!this.jsmdLocal.META.get(playerId,"isHalf")?window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-fifty",playerId):playhead>.25*duration&&!this.jsmdLocal.META.get(playerId,"isTwentyFive")?window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-twentyfive",playerId):playhead>.1*duration&&!this.jsmdLocal.META.get(playerId,"isTen")&&window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-ten",playerId))},onAdPlay:function(evt,containerId,playerId,token,mode,id,duration){playerId=this.getPlayerId(playerId),this.jsmdLocal.CONTENT.ad_duration=duration,window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-preroll",playerId)},onAdEnd:function(evt,containerId,playerId,token,mode,id,blockId,adType){playerId=this.getPlayerId(playerId),adType!==void 0&&"midroll"===adType&&window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-midroll-complete",playerId)},onContentPause:function(evt,containerId,playerId,contentId,paused){playerId=this.getPlayerId(playerId),window.debugMsg("JSMDAnalyticsEventHandler onContentPause: containerId:"+containerId),this.jsmdLocal.CONTENT.paused=paused,window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-pause",playerId)},onTrackingContentSeek:function(evt,containerId,playerId){playerId=this.getPlayerId(playerId),window.debugMsg("JSMDAnalyticsEventHandler onTrackingContentSeek: containerId:"+containerId),window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-scrub",playerId)},onContentBuffering:function(evt,containerId,playerId,contentId,buffering){playerId=this.getPlayerId(playerId),window.debugMsg("JSMDAnalyticsEventHandler onContentBuffering: containerId:"+containerId),this.jsmdLocal.CONTENT.buffering=buffering,window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-buffer",playerId)}}),CNNVIDEOAPI.JSMDJumbotronTrackingEventHandler=CNNVIDEOAPI.JSMDNewAPIVideoTrackingEventHandler.extend({onContentPlay:function(evt,containerId,playerId,contentId){playerId=this.getPlayerId(playerId);var eventType="cnnvideo-start";this.getVideoInstance().isUnAuthLive&&this.getVideoInstance().isUnAuthLive(contentId)&&(eventType="cnnvideo-live"),window.trackVideoEvent(this.jsmdLocal.CONTENT,eventType,playerId)}}),CNNVIDEOAPI.JSMDTVEAPIVideoTrackingEventHandler=CNNVIDEOAPI.CVPEventSubscriber.extend({init:function(publisher,eventDispatcher,videoConfig,analyticsConfig){this.jsmdLocal={},this.videoConfig=videoConfig,this.analyticsConfig=analyticsConfig,this.initialize(),this._super(publisher,eventDispatcher,videoConfig,"jsmdAnalyticsTVEAPI")},initialize:function(){if(this.analyticsConfig&&this.analyticsConfig.metadata)for(var metaName in this.analyticsConfig.metadata)window.debugMsg("JSMDTVEAPIVideoTrackingEventHandler will set metadata for variable'"+metaName+"' to "+(""+this.analyticsConfig.metadata[metaName])+". If you don't want didn't want to set this variable in the loader, please check your analytics configuration"),CNNVIDEOAPI.Utils.generateWindowVariables(metaName,this.analyticsConfig.metadata[metaName])},initMethods:function(){this.methodsToSubscribeTo="onContentMetadata onPlayerReady onContentBegin onTrackingAdStart onTrackingAdComplete onTrackingContentPlay onTrackingPaused onContentBuffering onTrackingContentSeek onTrackingContentComplete".split(" ")},getVideoInstance:function(){return this.publisher&&this.publisher.videoInstance?(this.vInst=this.publisher.videoInstance,this.vInst):{cvp:{}}},getPlayerId:function(defaultValue){return(!this.publisher||this.publisher instanceof CNNVIDEOAPI.CNNVideoPlayerBase)&&this.publisher.getGUID()?this.publisher.getGUID():defaultValue},onPlayerReady:function(evt,containerId,playerId){try{playerId=this.getPlayerId(playerId);var cvp=this.getVideoInstance().cvp;cvp.setAdKeyValue("transactionID",cnnad_transactionID),cvp.setAdKeyValue("guID",cnnad_readCookie("ug"))}catch(err){}},onContentBegin:function(evt,containerId,playerId,contentId){window.debugMsg("onContentBegin in JSMDAnalyticsHandler: containerId:"+containerId),playerId=this.getPlayerId(playerId),!window.jsmd&&_jsmd&&(window.jsmd=_jsmd.init()),this.jsmdLocal.META=new window._jsmd.plugin.gCNNVideoCollection,this.getVideoInstance()&&this.getVideoInstance().videoMetadata&&delete this.getVideoInstance().videoMetadata;try{this.getVideoInstance().getContentEntry&&this.getVideoInstance().getContentEntry(contentId)}catch(error){}if(this.jsmdLocal.CONTENT=this.getVideoInstance().videoMetadata?this.getVideoInstance().videoMetadata:{id:contentId},this.jsmdLocal.CONTENT.playerid=playerId,this.jsmdLocal.CONTENT.category=this.videoConfig.section,0===contentId.indexOf("cvptve/")){this.jsmdLocal.CONTENT.player_type="tve",this.jsmdLocal.CONTENT.auth_state="required authentication";var sessionGUID;try{this.videoConfig.accessToken&&(sessionGUID=jQuery(this.videoConfig.accessToken).find("sessionGUID").text())}catch(error){}this.jsmdLocal.CONTENT.adobe_hash_id=this.videoConfig.accessToken&&sessionGUID?sessionGUID:this.videoConfig.accessToken,void 0!==typeof CNN&&void 0!==typeof CNN.TVEAuth&&void 0!==typeof CNN.TVEAuth.mvpdconfig&&(this.jsmdLocal.CONTENT.mvpd=CNN.TVEAuth.mvpdconfig.id);try{var arrayIndex=contentId.indexOf("cvpstream1")>=0?0:1,nowPlayingData=CNN.VideoAjax.NowPlaying.getServerData(),channelArray=nowPlayingData.channel,channel=channelArray[arrayIndex];this.jsmdLocal.CONTENT.show_name=channel.program,this.jsmdLocal.CONTENT.live_stream_name=contentId.indexOf("cvpstream1")>=0?"cnn news":"hln news"}catch(nowPlayingError){window.errorMsg("error retrieving now playing data for analytics",nowPlayingError)}}else this.jsmdLocal.CONTENT.player_type="live",this.jsmdLocal.CONTENT.auth_state="does not require authentication"},onTrackingAdStart:function(evt,containerId,playerId,dataObj){try{playerId=this.getPlayerId(playerId),this.jsmdLocal.CONTENT.ad_duration=dataObj.adDuration,window.trackMetrics({type:"cnnvideo-preroll",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onTrackingAdComplete:function(){try{window.trackMetrics({type:"cnnvideo-adcomplete",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onTrackingContentPlay:function(evt,containerId,playerId,dataObj){try{playerId=this.getPlayerId(playerId),window.live_interval=0===dataObj.contentId.indexOf("cvptve/")?60:0,window.trackMetrics({type:"cnnvideo-live",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onTrackingPaused:function(evt,containerId,playerId,dataObj){try{this.jsmdLocal.CONTENT.paused=dataObj.paused,window.trackMetrics({type:"cnnvideo-pause",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onContentBuffering:function(evt,containerId,playerId,contentId,buffering){try{playerId=this.getPlayerId(playerId),this.jsmdLocal.CONTENT.buffering=buffering,this.trackMetrics({type:"cnnvideo-buffer",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onTrackingContentSeek:function(evt,containerId,playerId){try{playerId=this.getPlayerId(playerId),window.trackMetrics({type:"cnnvideo-scrub",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onTrackingContentComplete:function(evt,containerId,playerId){try{playerId=this.getPlayerId(playerId),window.trackMetrics({type:"cnnvideo-complete",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onContentMetadata:function(evt,containerId,playerId){try{playerId=this.getPlayerId(playerId)}catch(e){}}}),CNNVIDEOAPI.JSMDVANAPIVideoTrackingEventHandler=CNNVIDEOAPI.CVPEventSubscriber.extend({init:function(publisher,eventDispatcher,videoConfig,analyticsConfig){this.jsmdLocal={},this.affilateId="no value set",this.analyticsConfig=analyticsConfig,this.initialize(),this._super(publisher,eventDispatcher,videoConfig,"jsmdAnalyticsVANAPI")},initialize:function(){if(this.analyticsConfig&&(this.analyticsConfig.affilateId!==void 0&&(this.affilateId=this.analyticsConfig.affilateId),this.analyticsConfig.metadata))for(var metaName in this.analyticsConfig.metadata)CNNVIDEOAPI.Utils.generateWindowVariables(metaName,this.analyticsConfig.metadata[metaName]),window.debugMsg("JSMDVANAPIVideoTrackingEventHandler set metadata for variable'"+metaName+"' to "+(""+this.analyticsConfig.metadata[metaName]))},initMethods:function(){this.methodsToSubscribeTo="onPlayerReady onContentBegin onContentComplete onContentPlayhead onTrackingAdStart onTrackingPaused onTrackingContentPlay onTrackingContentSeek onContentBuffering".split(" ")},getVideoInstance:function(){return this.publisher&&this.publisher.videoInstance?(this.vInst=this.publisher.videoInstance,this.vInst):{cvp:{}}},getPlayerId:function(defaultValue){return(!this.publisher||this.publisher instanceof CNNVIDEOAPI.CNNVideoPlayerBase)&&this.publisher.getGUID()?this.publisher.getGUID():defaultValue},onPlayerReady:function(evt,containerId,playerId){try{playerId=this.getPlayerId(playerId);var cvp=this.getVideoInstance().cvp;cvp.setAdKeyValue("transactionID",cnnad_transactionID),cvp.setAdKeyValue("guID",cnnad_readCookie("ug"))}catch(err){}},onContentBegin:function(evt,containerId,playerId,contentId){playerId=this.getPlayerId(playerId),window.debugMsg("JSMDVANAPIVideoTrackingEventHandler onContentBegin in JSMDAnalyticsHandler: containerId:"+containerId),!window.jsmd&&_jsmd&&(window.jsmd=_jsmd.init()),this.jsmdLocal.META=new window._jsmd.plugin.gCNNVideoCollection,this.getVideoInstance()&&this.getVideoInstance().videoMetadata&&delete this.getVideoInstance().videoMetadata;try{this.getVideoInstance().getContentEntry&&this.getVideoInstance().getContentEntry(contentId)}catch(error){}this.jsmdLocal.CONTENT=this.getVideoInstance().videoMetadata?this.getVideoInstance().videoMetadata:{id:contentId},this.jsmdLocal.CONTENT.playerid=playerId,this.jsmdLocal.CONTENT.player_type="van",this.jsmdLocal.CONTENT.consumer=this.affilateId},onTrackingAdStart:function(evt,containerId,playerId,dataObj){playerId=this.getPlayerId(playerId);try{this.jsmdLocal.CONTENT.ad_duration=dataObj.adDuration,trackMetrics({type:"cnnvideo-preroll",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onTrackingContentPlay:function(evt,containerId,playerId){playerId=this.getPlayerId(playerId);try{var eventType="cnnvideo-start";trackMetrics({type:eventType,data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onTrackingPaused:function(evt,containerId,playerId,dataObj){playerId=this.getPlayerId(playerId);try{this.jsmdLocal.CONTENT.paused=dataObj.paused,trackMetrics({type:"cnnvideo-pause",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onContentComplete:function(evt,containerId,playerId){playerId=this.getPlayerId(playerId),window.trackVideoEvent(this.jsmdLocal.CONTENT,"cnnvideo-complete",playerId)},onContentPlayhead:function(evt,containerId,playerId,contentId,playhead,duration){playerId=this.getPlayerId(playerId),void 0===this.jsmdLocal.META||void 0===playhead||this.jsmdLocal.META.get(playerId,"hasScrubbed")||(playhead>.75*duration&&!this.jsmdLocal.META.get(playerId,"isSeventyFive")?trackMetrics({type:"cnnvideo-seventyfive",data:{video:this.jsmdLocal.CONTENT}}):playhead>.5*duration&&!this.jsmdLocal.META.get(playerId,"isHalf")?trackMetrics({type:"cnnvideo-fifty",data:{video:this.jsmdLocal.CONTENT}}):playhead>.25*duration&&!this.jsmdLocal.META.get(playerId,"isTwentyFive")?trackMetrics({type:"cnnvideo-twentyfive",data:{video:this.jsmdLocal.CONTENT}}):playhead>.1*duration&&!this.jsmdLocal.META.get(playerId,"isTen")&&trackMetrics({type:"cnnvideo-ten",data:{video:this.jsmdLocal.CONTENT}}))},onTrackingContentSeek:function(evt,containerId,playerId){playerId=this.getPlayerId(playerId),window.debugMsg("JSMDAnalyticsEventHandler onTrackingContentSeek: containerId:"+containerId);try{trackMetrics({type:"cnnvideo-scrub",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}},onContentBuffering:function(evt,containerId,playerId,contentId,buffering){playerId=this.getPlayerId(playerId),window.debugMsg("JSMDAnalyticsEventHandler onContentBuffering: containerId:"+containerId);try{this.jsmdLocal.CONTENT.buffering=buffering,trackMetrics({type:"cnnvideo-buffer",data:{video:this.jsmdLocal.CONTENT}})}catch(e){}}}),CNNVIDEOAPI.CNNVideoPlayerBase=CNNVIDEOAPI.ClassBase.extend({CVP_METHODS:"resume seek resize getContentEntry".split(" "),init:function(config,contextObj){this.topics={},this.subUid=-1,this.eventListeners={},this._config=config,this._context=contextObj,this.videoConfig=this._config.videoConfig,this.eventsCallback=this._config.eventsCallback?this._config.eventsCallback:{},this.overrides=this._config.overridesConfig,this.setMarkupId(),this.setParentMarkupId(),this.initializeContainer(),this.eventsCallback&&this.addEventHandler(new CNNVIDEOAPI.ClientEventCallbacksWrapper(this,this.eventsCallback)),this.addEventHandler(new CNNVIDEOAPI.APIVideoHelperEventHandler(this))},onCVPSrcLoaded:function(){this.initializeContainer()},publish:function(topic,functionName,args){if(!this.topics[topic])return!1;var subscribers=this.topics[topic];if(subscribers)for(var len=0;subscribers.length>len;len++)subscribers[len],subscribers[len].func(this,topic,functionName,args);return this},subscribe:function(topic,func){this.topics[topic]||(this.topics[topic]=[]);var token=""+ ++this.subUid;return this.topics[topic].push({token:token,func:func}),token},unsubscribe:function(token){for(var m in this.topics)if(this.topics[m])for(var i=0,j=this.topics[m].length;j>i;i++)if(this.topics[m][i].token===token)return this.topics[m].splice(i,1),token;return this},addEventHandler:function(evtHandler){this.videoConfig.context,this.eventListeners[evtHandler.topic]||(this.eventListeners[evtHandler.topic]=evtHandler)},allowAutoPause:function(){return this.videoConfig&&void 0!==this.videoConfig.allowAutoPause?this.videoConfig.allowAutoPause:!0},pause:function(){},initMethods:function(){},onPlayHandler:function(data){CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(data.name)},onEventHandler:function(data){var name=data.name,type=data.type;this.doCallback(type,name,data.event)},initVideoAnalytics:function(){for(var type=this.videoConfig.context,analtyicsHandlers=CNNVIDEOAPI.AnalyticsFactory.getAnalyticsFronContext(this,this._context.contexts?this._context.contexts:this._context,type),i=0;analtyicsHandlers.length>i;i++)this.addEventHandler(analtyicsHandlers[i])},doCallback:function(functionName,frameName,data){try{for(var topicKeys=Object.keys(this.eventListeners),i=0;topicKeys.length>i;i++){var evtListener=this.eventListeners[topicKeys[i]];this.publish(evtListener.topic,functionName,data)}}catch(error){}},getGUID:function(){return void 0!==this._guid&&this._guid||(this._guid="cnnvideo_"+Math.round(1e9*Math.random()).toString(16)),this._guid},getMarkupId:function(){return this._markupId},setMarkupId:function(){this._markupId=this.getGUID()},getParentMarkupId:function(){return this._parentMarkupId},setParentMarkupId:function(){this._parentMarkupId=this.videoConfig.markupId},onVideoContainerReady:function(elem){this.eventsCallback.onVideoContainerReady&&"function"==typeof this.eventsCallback.onVideoContainerReady&&this.eventsCallback.onVideoContainerReady(this.getParentMarkupId(),this.getMarkupId(),elem,this)},initializeContainer:function(){window.errorMsg("CNNVideoPlayerBase .initializeContainer should be overridden")},stop:function(){window.errorMsg("CNNVideoPlayerBase .stop should be overridden")},play:function(){window.errorMsg("CNNVideoPlayerBase .play should be overridden")},replay:function(){window.errorMsg("CNNVideoPlayerBase .replay should be overridden")}}),CNNVIDEOAPI.CNNEmbeddedVideoPlayer=CNNVIDEOAPI.CNNVideoPlayerBase.extend({videoInstance:{},init:function(config,contextObj){this._super(config,contextObj)},stop:function(){this.videoInstance.stopVideo()},replay:function(){this.videoInstance.replayVideo()},play:function(videoId,videoOverrides){this.videoInstance.playVideo(videoId,videoOverrides),window.debugMsg("CNNEmbeddedVideoPlayer .play has been called")},pause:function(){this.videoInstance&&this.videoInstance.cvp&&this.videoInstance.cvp.pause()},setMarkupId:function(){this._markupId=this.videoConfig.markupId},setParentMarkupId:function(){this._parentMarkupId=this.videoConfig.frameId?this.videoConfig.frameId:this.videoConfig.markupId},initVideoAnalytics:function(){var analtyicsHandlers,type=this.videoConfig.context;analtyicsHandlers=this.videoConfig.analytics!==void 0&&null!==this.videoConfig.analytics?CNNVIDEOAPI.AnalyticsFactory.getAnalytics(this,this.videoConfig.analytics):CNNVIDEOAPI.AnalyticsFactory.getAnalyticsFronContext(this,this._context.contexts?this._context.contexts:this._context,type);for(var i=0;analtyicsHandlers.length>i;i++)this.addEventHandler(analtyicsHandlers[i])},initMethods:function(){for(var i=0,l=this.CVP_METHODS.length;l>i;i++){var name=this.CVP_METHODS[i];void 0===this[name]&&(this[name]=this.createProxyFunction(name))}},onCVPEventHandler:function(evt){evt.name=this.getMarkupId(),this.onEventHandler(evt),jQuery(this).trigger(evt.type,evt.event)},initCVPEventListener:function(){for(var i=0,l=VideoPlayer.CVP_EVENTS.length;l>i;i++){var name=VideoPlayer.CVP_EVENTS[i];jQuery(this.videoInstance).on(name,this.createCVPProxyEvent.call(this,name))}},createCVPProxyEvent:function(name){var pointer=this;return function(){var argv=[].slice.apply(arguments);argv.shift();var data=argv,eventData=[];if(eventData.push(pointer.getMarkupId()),data.length>=1)for(var paramsInd=1;data.length>paramsInd;paramsInd++){var paramVal=data[paramsInd];eventData.push(paramVal)}var evt={action:"event",type:name,data:data,event:eventData};pointer.onCVPEventHandler(evt)}},createProxyFunction:function(name){return function(){var argv=[].slice.apply(arguments);return argv.unshift(name),this.videoInstance.cvp[name].apply(this.videoInstance.cvp,arguments)}},initializeContainer:function(){var playerContexts=this._context.contexts?this._context.contexts:this._context,updatedConfig={video:this.videoConfig.video,thumb:this.videoConfig.thumb,diagnostics:{section:this.videoConfig.section||this.videoConfig.profile,placement:this.videoConfig.placement},adPolicyContext:this.videoConfig.cvpAdPolicyContext?this.videoConfig.cvpAdPolicyContext:"",network:(this.videoConfig.cvpNetwork?this.videoConfig.cvpNetwork:this.videoConfig.network)||"cnn",section:this.videoConfig.section,profile:this.videoConfig.cvpProfile?this.videoConfig.cvpProfile:playerContexts&&playerContexts.default&&playerContexts.default.cvpProfile?playerContexts.default.cvpProfile:this.videoConfig.profile,context:this.videoConfig.cvpContext?this.videoConfig.cvpContext:playerContexts&&playerContexts.default&&playerContexts.default.cvpContext?playerContexts.default.cvpContext:this.videoConfig.context,adsection:this.videoConfig.adsection?this.videoConfig.adsection:playerContexts["default"]&&playerContexts["default"].adsection?playerContexts["default"].adsection:"",headline:this.videoConfig.headline,headlineUrl:this.videoConfig.url,height:this.videoConfig.height,width:this.videoConfig.width,autostart:this.videoConfig.autostart,source:this.videoConfig.source||this.videoConfig.videoSource,sourceUrl:this.videoConfig.sourceUrl||this.videoConfig.videoSourceUrl,isLive:this.videoConfig.isLive,videoStreamUrl:this.videoConfig.videoStreamUrl};this.videoConfig.adKeyValues!==void 0&&(updatedConfig.adKeyValues=this.videoConfig.adKeyValues),this.videoConfig.accessToken!==void 0&&(updatedConfig.accessToken=this.videoConfig.accessToken),this.videoConfig.accessTokenType!==void 0&&(updatedConfig.accessTokenType=this.videoConfig.accessTokenType),this.videoInstance=new VideoPlayer(this.getMarkupId(),this.getGUID(),updatedConfig),this.initMethods(),this.initCVPEventListener(),this.initVideoAnalytics()}}),CNNVIDEOAPI.CNNIFrameVideoPlayer=CNNVIDEOAPI.CNNVideoPlayerBase.extend({frameHtmlElem:null,framePath:"",IFRAME_URL_ARG_KEYS:"cvpAdPolicyContext frameId client adKeyValues type section cvpNetwork cvpContext cvpProfile width height adsection autostart network video profile context thumb".split(" "),init:function(config,contextObj){this._super(config,contextObj),this.framePath=this.videoConfig.iframeConfig.iframeHost},stop:function(){var postData=window.JSON.stringify({action:"stop",name:this.getMarkupId()});this.frameHtmlElem.postMessage(postData,this.framePath),CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(this.getMarkupId())},replay:function(){var postData=window.JSON.stringify({action:"replay",name:this.getMarkupId()});this.frameHtmlElem.postMessage(postData,this.framePath),CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(this.getMarkupId())
},play:function(videoId,videoOverrides){var postData=window.JSON.stringify({action:"play",name:this.getMarkupId(),video:{video:videoId,videoOverrides:videoOverrides?videoOverrides:{}}});this.frameHtmlElem.postMessage(postData,this.framePath),CNNVIDEOAPI.CNNVideoManager.getInstance().pauseOthers(this.getMarkupId())},pause:function(){var postData=window.JSON.stringify({action:"pause"});this.frameHtmlElem.postMessage(postData,this.framePath)},initMethods:function(){if(this.frameHtmlElem)for(var i=0,l=this.CVP_METHODS.length;l>i;i++){var name=this.CVP_METHODS[i];void 0===this[name]&&(this[name]=this.createProxyFunction(name))}else window.warnMsg&&window.warnMsg("frame not found "+frame)},createProxyFunction:function(name){return this.frameHtmlElem?function(){var argv=[].slice.apply(arguments),obj={action:name,data:argv},postData=window.JSON.stringify(obj);this.frameHtmlElem.postMessage(postData,this.framePath)}:void 0},initializeContainer:function(){if(!this.videoConfig.iframeConfig){if(this._context["default"]&&!this._context["default"].iframeConfig)throw Error("iframeConfig not found in the this player's context ("+this.videoConfig.context+") and one was not found in the default context. Check your settings in the sectionconfig.json. ");window.debugMsg("iframeConfig not found in the this player's context ("+this.videoConfig.context+") . Using the definition in the default context. "),this.videoConfig.iframeConfig=this._context["default"].iframeConfig}this.createVideoFrame(this.getParentMarkupId(),this.eventsCallback)},onFrameReadyHandler:function(retFrameId){this.frameHtmlElem=window.frames[this.getMarkupId()],this.initMethods(),window.debugMsg("CNNIFrameVideoPlayer  onFrameReadyHandler retFrameId:"+retFrameId+"parentId:"+this.getParentMarkupId()+"\n");var data={};data.type="onVideoContainerReady",data.name="clientEventWrapper",data.event=[jQuery("#"+retFrameId).parent().attr("id"),retFrameId,this.frameHtmlElem,this],this.doCallback("onVideoContainerReady",this.getMarkupId(),data.event)},containsKey:function(obj,key){return void 0!==obj[key]&&null!==obj[key]&&""!==obj[key]},generateIFrameParameters:function(){for(var retObj={},i=0;this.IFRAME_URL_ARG_KEYS.length>i;i++){var keyName=this.IFRAME_URL_ARG_KEYS[i];this.containsKey(this.videoConfig,keyName)&&(retObj[keyName]=this.videoConfig[keyName])}return this.overrides&&jQuery.extend(retObj,this.overrides),retObj.type="iframe_client",this.containsKey(CNNVIDEOAPI,"currentVersion")&&(retObj.apiVersion=CNNVIDEOAPI.currentVersion),this.containsKey(CNNVIDEOAPI,"client")&&(retObj.client=CNNVIDEOAPI.client),retObj},createVideoFrame:function(target,callback){var frameId=this.getMarkupId(),path=this.videoConfig.iframeConfig.iframeHost,frameURI=this.videoConfig.iframeConfig.iframeHtml,iframeArgs=this.generateIFrameParameters(),frameURL=(0>frameURI.indexOf("http")?path:"")+frameURI+"?debug="+(window.debugMode!==void 0?window.debugMode:"false")+"&frameId="+frameId+"&"+jQuery.param(iframeArgs)+"#"+encodeURIComponent(window.document.location.href),parentElement=jQuery("#"+target).empty(),frameWidth=this.videoConfig.frameWidth||this.videoConfig.width,frameHeight=this.videoConfig.frameHeight||this.videoConfig.height;this.getParentMarkupId()+"",null!==callback&&"object"==typeof callback&&(callback.onFrameReadyHandler=jQuery.proxy(this.onFrameReadyHandler,this));var iframe=document.createElement("iframe");iframe.frameBorder=0,iframe.id=frameId,iframe.name=frameId,iframe.width=frameWidth,iframe.height=frameHeight,iframe.src=frameURL,jQuery(iframe).attr("scrolling","no"),parentElement.append(iframe)},broker:function(e){if(e.origin!=this.videoConfig.iframeConfig.iframeHost)return window.warnMsg("origin does not match frame path!",e.origin,this.framePath),void 0;var data=this.deserializeData(e.data);if(data.name===this.getMarkupId())return data.action?("play"===data.action?this.onPlayHandler(data):"event"===data.action?this.onEventHandler(data):"windowready"===data.action?this.onFrameReadyHandler(data.name):window.warnMsg("no action specified or unknown action",data.action,data),void 0):(window.warnMsg("CNNIFrameVideoPlayer .broker no action specified in data."),void 0)},deserializeData:function(data){if(null===data||""===data)return null;if("object"!=typeof data)try{data=window.JSON.parse(data)}catch(err){data=jQuery.deparam(data)}return data}});